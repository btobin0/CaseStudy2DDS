"0","q8_v2 = "
"0","  q8 %>%"
"0","  select(beer_type, ABV, IBU) %>%"
"0","  na.omit() #knn function does not accept missing values"
"0","#Select train and test datasets "
"0","r = nrow(q8_v2)"
"0","p = 0.8 "
"0","n = as.integer(p*r)"
"0","set.seed(198)"
"0","iterations = 100"
"0","ks = 25"
"0","accuracies = matrix(nrow = iterations, ncol = ks)"
"0","set.seed(189)"
"0","myseeds = runif(iterations) %>% multiply_by(1000) %>% round()"
"0","for(j in 1:iterations)"
"0","{"
"0","  set.seed(myseeds[j])"
"0","  index = sample(1:r, n, replace = F)"
"0","  test.data = q8_v2[index,] "
"0","  train.data = q8_v2[-index,]"
"0","  for(i in 1:ks)"
"0","  {"
"0","    knn("
"0","      train = train.data %>% select(ABV, IBU), "
"0","      test = test.data %>% select(ABV, IBU), "
"0","      cl = train.data %$% beer_type, "
"0","      k = i, prob = F"
"0","      ) -> knn_v0"
"0","    confMat = confusionMatrix(table(knn_v0, test.data$beer_type))"
"0","    accuracies[j,i] = confMat$overall[1]"
"0","  }"
"0","  #cat(j, ""\n"")"
"0","}"
"0","plot(1:ks, colMeans(accuracies), type = ""b"", lwd=1, pch=19, col=""navy"", "
"0","     xlab = ""Number of neighbours"", ylab = ""Accuracy"")"
