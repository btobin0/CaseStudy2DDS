"0","# Gather data to be analyzed"
"0","TestD = "
"0","  NTD %>%"
"0","  select(Age,JobLevel,JobSatisfaction,TotalWorkingYears,YearsSinceLastPromotion,MonthlyIncome,Title) %>%"
"0","  na.omit() #knn function does not accept missing values"
"0","# Train and Test Data"
"0","r = nrow(TestD)"
"0","p = 0.75 "
"0","n = as.integer(p*r)"
"0","set.seed(198)"
"0","iterations = 100"
"0","ks = 25"
"0","accuracies = matrix(nrow = iterations, ncol = ks)"
"0","set.seed(100)"
"0","myseeds = runif(iterations) %>% multiply_by(10) %>% round()"
"0","for(j in 1:iterations)"
"0","{"
"0","  set.seed(myseeds[j])"
"0","  index = sample(1:r, n, replace = F)"
"0","  test.data = TestD[index,] "
"0","  train.data = TestD[-index,]"
"0","  for(i in 1:ks)"
"0","  {"
"0","    knn("
"0","      train = train.data %>% select(TotalWorkingYears,YearsSinceLastPromotion), "
"0","      test = test.data %>% select(TotalWorkingYears,YearsSinceLastPromotion), "
"0","      cl = train.data %$% JobSatisfaction, "
"0","      k = i, prob = F"
"0","      ) -> knn_v0"
"0","    confMat = confusionMatrix(table(knn_v0, test.data$JobSatisfaction))"
"0","    accuracies[j,i] = confMat$overall[1]"
"0","  }"
"0","}"
